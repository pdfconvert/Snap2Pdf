<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PowerPoint to Word Converter</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        :root { --primary: #4361ee; --primary-dark: #3a0ca3; --secondary: #f72585; --success: #4cc9f0; --light: #f8f9fa; --dark: #212529; --gray: #6c757d; --border-radius: 12px; --box-shadow: 0 5px 15px rgba(0,0,0,0.08); --transition: all 0.3s ease; }
        body { background: linear-gradient(135deg, #f5f7ff 0%, #e9ecef 100%); color: var(--dark); min-height: 100vh; line-height: 1.6; display:flex; flex-direction:column; }
        .container { width: 100%; max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        /* Header (from index.html) */
        header { background: #fff; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 10px rgba(0,0,0,.08); }
        .navbar { display: flex; justify-content: space-between; align-items: center; padding: 14px 0; }
        .logo { display: flex; gap: 10px; align-items: center; font-size: 22px; font-weight: 700; color: var(--primary); text-decoration: none; }
        .logo i { color: var(--primary-dark); }
        .nav-links { display: flex; gap: 22px; }
        .nav-links a { text-decoration: none; color: var(--dark); font-weight: 500; }
        .nav-links a.active, .nav-links a:hover { color: var(--primary); }
        .dropdown { position: relative; }
        .dropdown-content { display: none; position: absolute; background: #fff; min-width: 200px; box-shadow: 0 8px 16px rgba(0,0,0,.1); border-radius: 8px; padding: 10px 0; top: 100%; left: 0; }
        .dropdown:hover .dropdown-content { display: block; }
        .dropdown-content a { display: block; padding: 10px 20px; text-decoration: none; color: var(--dark); }
        .dropdown-content a:hover { background: var(--light); }
        .auth-buttons { display:flex; gap:10px; }
        .auth-btn { padding:6px 15px; border-radius:50px; text-decoration:none; font-weight:500; transition:.3s; font-size:.9rem; }
        .auth-btn.login { background: transparent; color: var(--primary); border:1px solid var(--primary); }
        .auth-btn.signup { background: var(--primary); color:#fff; border:1px solid var(--primary); }
        /* Page specific */
        .page-wrap { padding: 20px 0; }
        .converter-header { text-align: center; margin-bottom: 30px; padding: 20px; }
        .converter-header h1 { font-size: 2.2rem; color: var(--primary); margin-bottom: 10px; }
        .converter-header p { font-size: 1.05rem; color: var(--gray); max-width: 700px; margin: 0 auto; }
        .converter-card { background: #fff; border-radius: var(--border-radius); padding: 30px; box-shadow: var(--box-shadow); margin-bottom: 30px; }
        .upload-area { border: 3px dashed #ddd; border-radius: var(--border-radius); padding: 40px 20px; text-align: center; cursor: pointer; margin-bottom: 20px; transition: var(--transition); position: relative; }
        .upload-area:hover { border-color: var(--primary); background: rgba(67, 97, 238, 0.03); }
        .upload-area.dragover { border-color: var(--primary); background: rgba(67, 97, 238, 0.08); }
        .upload-icon { font-size: 64px; color: var(--primary); margin-bottom: 15px; }
        .upload-area h3 { font-size: 1.5rem; margin-bottom: 10px; color: var(--dark); }
        .upload-area p { color: var(--gray); margin-bottom: 5px; }
        .file-input { display: none; }
        .file-info { background: var(--light); border-radius: var(--border-radius); padding: 20px; margin: 20px 0; display: none; }
        .file-details { display: flex; align-items: center; gap: 15px; }
        .file-icon { font-size: 40px; color: var(--primary); }
        .file-text h4 { font-size: 1.2rem; margin-bottom: 5px; }
        .file-text p { color: var(--gray); font-size: 0.9rem; }
        .options-section { margin: 25px 0; padding: 20px; background: var(--light); border-radius: var(--border-radius); }
        .options-section h3 { margin-bottom: 15px; color: var(--primary); }
        .option-group { margin-bottom: 15px; }
        .option-group label { display: block; margin-bottom: 8px; font-weight: 500; }
        .option-select { width: 100%; padding: 10px 15px; border: 1px solid #ddd; border-radius: 8px; background: white; font-size: 1rem; }
        .checkbox-group { display: flex; align-items: center; gap: 10px; }
        .checkbox-group input { width: 18px; height: 18px; }
        .action-buttons { display: flex; gap: 15px; margin-top: 25px; flex-wrap: wrap; }
        .btn { display: inline-flex; align-items: center; justify-content: center; gap: 8px; padding: 12px 24px; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: var(--transition); text-decoration: none; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: var(--primary-dark); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .btn-secondary { background: white; color: var(--primary); border: 2px solid var(--primary); }
        .btn-secondary:hover { background: var(--light); }
        .btn:disabled { background: #ccc; cursor: not-allowed; transform: none; box-shadow: none; }
        .progress-container { margin: 20px 0; display: none; }
        .progress-bar { width: 100%; height: 10px; background: #e9ecef; border-radius: 5px; overflow: hidden; }
        .progress { height: 100%; background: linear-gradient(90deg, var(--primary), var(--success)); width: 0%; transition: width 0.4s ease; }
        .progress-text { text-align: center; margin-top: 10px; color: var(--gray); font-size: 0.9rem; }
        .loading { display: none; text-align: center; padding: 30px; }
        .loading-spinner { border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 0 auto 20px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .message { padding: 15px; border-radius: 8px; margin: 20px 0; display: none; }
        .success-message { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error-message { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .preview-section { margin-top: 30px; display: none; }
        .preview-container { border: 1px solid #ddd; border-radius: var(--border-radius); padding: 20px; background: white; max-height: 500px; overflow: auto; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .preview-title { font-size: 1.2rem; margin-bottom: 15px; color: var(--primary); display: flex; justify-content: space-between; align-items: center; }
        .features { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 40px; }
        .feature-card { background: white; border-radius: var(--border-radius); padding: 25px; box-shadow: var(--box-shadow); text-align: center; transition: var(--transition); }
        .feature-card:hover { transform: translateY(-5px); }
        .feature-icon { font-size: 40px; color: var(--primary); margin-bottom: 15px; }
        .feature-card h3 { margin-bottom: 10px; color: var(--dark); }
        .feature-card p { color: var(--gray); font-size: 0.9rem; }
        /* Footer */
        footer { background: #212529; color: #fff; margin-top: auto; padding: 60px 0 30px; }
        .footer-content { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 40px; margin-bottom: 40px; }
        .footer-links { list-style: none; }
        .footer-links a { color: #aaa; text-decoration: none; }
        .footer-links a:hover { color: #fff; }
        .copyright { text-align: center; color: #aaa; border-top: 1px solid #444; padding-top: 16px; font-size: .9rem; }
        @media (max-width: 768px) { .nav-links { display: none; } .action-buttons { flex-direction: column; } .btn { width: 100%; justify-content: center; } .features { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <!-- Header from index.html -->
    <header><div class="container"><nav class="navbar"><a href="index.html" class="logo"><i class="fas fa-file-pdf"></i><span>Snap2PDF</span></a><div class="nav-links"><a href="index.html" class="active">Home</a><div class="dropdown"><a href="#">Convert to PDF <i class="fas fa-chevron-down"></i></a><div class="dropdown-content"><a href="jpg-to-pdf.html">JPG to PDF</a><a href="word-to-pdf.html">Word to PDF</a><a href="excel-to-pdf.html">Excel to PDF</a><a href="ppt-to-pdf.html">PowerPoint to PDF</a></div></div><div class="dropdown"><a href="#">Convert from PDF <i class="fas fa-chevron-down"></i></a><div class="dropdown-content"><a href="pdf-to-jpg.html">PDF to JPG</a><a href="pdf-to-word.html">PDF to Word</a><a href="pdf-to-excel.html">PDF to Excel</a><a href="pdf-to-ppt.html">PDF to PowerPoint</a></div></div><div class="dropdown"><a href="#">Edit PDF <i class="fas fa-chevron-down"></i></a><div class="dropdown-content"><a href="merge-pdf.html">Merge PDF</a><a href="split-pdf.html">Split PDF</a><a href="compress-pdf.html">Compress PDF</a><a href="edit-pdf.html">Edit PDF</a><a href="protect-pdf.html">Protect PDF</a><a href="unlock-pdf.html">Unlock PDF</a><a href="watermark-pdf.html">Watermark PDF</a><a href="crop-pdf.html">Crop PDF</a></div></div>          <div class="dropdown"><a href="#">Image Tools <i class="fas fa-chevron-down"></i></a><div class="dropdown-content"><a href="image-compressor.html">Image Compressor</a><a href="image-resizer.html">Image Resizer</a><a href="image-editor.html">Image Editor</a><a href="background-remover.html">Background Remover</a><a href="ocr-image.html">OCR Image</a><a href="image-watermark.html">Image Watermark Tool</a></div></div>
<div class="dropdown"><a href="#">Design Tools <i class="fas fa-chevron-down"></i></a><div class="dropdown-content"><a href="resume-maker.html">Resume Maker</a><a href="biodata-maker.html">Biodata Maker</a><a href="ai-image-generator.html">AI Image Generator</a><a href="marriage-card.html">Marriage Card</a></div></div></div><div class="auth-buttons"><a href="#" class="au
th-btn login" onclick="showModal('login-modal')">Login</a><a href="#" class="auth-btn signup" onclick="showModal('signup-modal')">Sign Up</a></div></nav></div></header>

    <div class="container page-wrap">
        <!-- START: User provided PPT converter middle content -->
        <div class="converter-header">
            <h1>PowerPoint to Word Converter</h1>
            <p>Convert your PowerPoint presentations to editable Word documents with slide selection</p>
        </div>

        <div class="converter-card">
            <div class="upload-area" id="upload-area">
                <div class="upload-icon"><i class="fas fa-file-powerpoint"></i></div>
                <h3>Upload Your PowerPoint File</h3>
                <p>Drag & drop your .pptx or .ppt file here</p>
                <p>or click to browse files</p>
                <input type="file" id="file-input" class="file-input" accept=".pptx,.ppt,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation">
            </div>

            <div class="file-info" id="file-info">
                <div class="file-details">
                    <div class="file-icon"><i class="fas fa-file-powerpoint"></i></div>
                    <div class="file-text">
                        <h4 id="file-name">Presentation.pptx</h4>
                        <p id="file-size">0 KB</p>
                    </div>
                </div>
            </div>

            <div class="slide-selection" id="slide-selection" style="display:none;">
                <h3>Select Slides to Convert</h3>
                <div class="slide-list" id="slide-list"></div>
                <div class="checkbox-group" style="margin-top: 15px;">
                    <input type="checkbox" id="select-all-slides" checked>
                    <label for="select-all-slides">Select All Slides</label>
                </div>
            </div>

            <div class="options-section">
                <h3>Conversion Options</h3>
                <div class="option-group">
                    <label for="output-format">Output Format</label>
                    <select id="output-format" class="option-select">
                        <option value="docx">DOCX (Microsoft Word)</option>
                        <option value="doc">DOC (Microsoft Word 97-2003)</option>
                        <option value="pdf">PDF Document</option>
                        <option value="txt">Plain Text</option>
                    </select>
                </div>
                <div class="option-group">
                    <label for="page-layout">Page Layout</label>
                    <select id="page-layout" class="option-select">
                        <option value="portrait">Portrait</option>
                        <option value="landscape">Landscape</option>
                    </select>
                </div>
                <div class="checkbox-group"><input type="checkbox" id="include-notes" checked><label for="include-notes">Include speaker notes</label></div>
                <div class="checkbox-group"><input type="checkbox" id="include-images" checked><label for="include-images">Include images</label></div>
                <div class="checkbox-group"><input type="checkbox" id="preserve-formatting" checked><label for="preserve-formatting">Preserve formatting</label></div>
            </div>

            <div class="progress-container" id="progress-container">
                <div class="progress-bar"><div class="progress" id="progress-bar"></div></div>
                <div class="progress-text" id="progress-text">Initializing conversion...</div>
            </div>

            <div class="loading" id="loading"><div class="loading-spinner"></div><p>Converting your PowerPoint to Word...</p></div>
            <div class="success-message message" id="success-message"><i class="fas fa-check-circle"></i> Your PowerPoint has been successfully converted to Word!</div>
            <div class="error-message message" id="error-message"><i class="fas fa-exclamation-circle"></i> <span id="error-text">An error occurred during conversion</span></div>

            <div class="action-buttons"><button class="btn btn-primary" id="convert-btn" disabled><i class="fas fa-file-word"></i> Convert to Word</button><button class="btn btn-secondary" id="clear-btn"><i class="fas fa-trash"></i> Clear File</button></div>

            <div class="preview-section" id="preview-section" style="display:none;">
                <div class="preview-title">Preview <small id="preview-note" style="color:var(--gray);"></small></div>
                <div id="preview-container" class="preview-container"></div>
            </div>
        </div>

        <div class="features">
            <div class="feature-card"><div class="feature-icon"><i class="fas fa-layer-group"></i></div><h3>Slide Selection</h3><p>Choose which slides to include in your Word document</p></div>
            <div class="feature-card"><div class="feature-icon"><i class="fas fa-edit"></i></div><h3>Editable Output</h3><p>Convert to fully editable Word documents</p></div>
            <div class="feature-card"><div class="feature-icon"><i class="fas fa-bolt"></i></div><h3>Fast Conversion</h3><p>Convert PowerPoint to Word in seconds</p></div>
            <div class="feature-card"><div class="feature-icon"><i class="fas fa-shield-alt"></i></div><h3>Secure & Private</h3><p>Your files stay in your browser</p></div>
        </div>
    </div>

    <!-- Footer from index.html -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Snap2PDF</h3>
                    <p>Your all-in-one PDF solution for converting, editing, and managing documents with ease.</p>
                </div>
                <div class="footer-column">
                    <h3>Convert to PDF</h3>
                    <ul class="footer-links">
                        <li><a href="jpg-to-pdf.html">JPG to PDF</a></li>
                        <li><a href="word-to-pdf.html">Word to PDF</a></li>
                        <li><a href="excel-to-pdf.html">Excel to PDF</a></li>
                        <li><a href="ppt-to-pdf.html">PowerPoint to PDF</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Convert from PDF</h3>
                    <ul class="footer-links">
                        <li><a href="pdf-to-jpg.html">PDF to JPG</a></li>
                        <li><a href="pdf-to-word.html">PDF to Word</a></li>
                        <li><a href="pdf-to-excel.html">PDF to Excel</a></li>
                        <li><a href="pdf-to-ppt.html">PDF to PowerPoint</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Edit PDF</h3>
                    <ul class="footer-links">
                        <li><a href="merge-pdf.html">Merge PDF</a></li>
                        <li><a href="split-pdf.html">Split PDF</a></li>
                        <li><a href="compress-pdf.html">Compress PDF</a></li>
                        <li><a href="edit-pdf.html">Edit PDF</a></li>
                        <li><a href="protect-pdf.html">Protect PDF</a></li>
                        <li><a href="unlock-pdf.html">Unlock PDF</a></li>
                        <li><a href="watermark-pdf.html">Watermark PDF</a></li>
                        <li><a href="crop-pdf.html">Crop PDF</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Image Tools</h3>
                    <ul class="footer-links">
                        <li><a href="image-compressor.html">Image Compressor</a></li>
                        <li><a href="image-resizer.html">Image Resizer</a></li>
                        <li><a href="image-editor.html">Image Editor</a></li>
                        <li><a href="background-remover.html">Background Remover</a></li>
                        <li><a href="ocr-image.html">OCR Image</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Design Tools</h3>
                    <ul class="footer-links">
                        <li><a href="resume-maker.html">Resume Maker</a></li>
                        <li><a href="biodata-maker.html">Biodata Maker</a></li>
                        <li><a href="ai-image-generator.html">AI Image Generator</a></li>
                        <li><a href="marriage-card.html">Marriage Card</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Company</h3>
                    <ul class="footer-links">
                        <li><a href="index.html#about">About Us</a></li>
                        <li><a href="index.html#contact">Contact</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of Service</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Connect With Us</h3>
                    <ul class="footer-links">
                        <li><a href="#"><i class="fab fa-twitter"></i> Twitter</a></li>
                        <li><a href="#"><i class="fab fa-facebook"></i> Facebook</a></li>
                        <li><a href="#"><i class="fab fa-instagram"></i> Instagram</a></li>
                        <li><a href="#"><i class="fab fa-linkedin"></i> LinkedIn</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                
            <div class="copyright"><p class="attribution">Icons by Font Awesome (CC BY 4.0). Libraries: jsPDF (MIT), html2canvas (MIT), Mammoth (BSD-2-Clause). <a href="attributions.html">Details</a>.</p></div></div></footer>

    <script>
        let currentFile = null;
        let presentationData = null;
        let selectedSlides = [];
        let totalSlides = 0;
        // DOM Elements
        const uploadArea = document.getElementById('upload-area');
        const fileInput = document.getElementById('file-input');
        const fileInfo = document.getElementById('file-info');
        const fileName = document.getElementById('file-name');
        const fileSize = document.getElementById('file-size');
        const slideSelection = document.getElementById('slide-selection');
        const slideList = document.getElementById('slide-list');
        const selectAllSlides = document.getElementById('select-all-slides');
        const convertBtn = document.getElementById('convert-btn');
        const clearBtn = document.getElementById('clear-btn');
        const progressContainer = document.getElementById('progress-container');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const loading = document.getElementById('loading');
        const successMessage = document.getElementById('success-message');
        const errorMessage = document.getElementById('error-message');
        const errorText = document.getElementById('error-text');
        const previewSection = document.getElementById('preview-section');
        const previewContainer = document.getElementById('preview-container');
        const previewNote = document.getElementById('preview-note');
        // Event Listeners
        uploadArea.addEventListener('click', () => fileInput.click());
        uploadArea.addEventListener('dragover', (e) => { e.preventDefault(); uploadArea.classList.add('dragover'); });
        uploadArea.addEventListener('dragleave', () => { uploadArea.classList.remove('dragover'); });
        uploadArea.addEventListener('drop', (e) => { e.preventDefault(); uploadArea.classList.remove('dragover'); handleFile(e.dataTransfer.files[0]); });
        fileInput.addEventListener('change', (e) => { if (e.target.files.length > 0) handleFile(e.target.files[0]); });
        convertBtn.addEventListener('click', convertToWord);
        clearBtn.addEventListener('click', clearFile);
        selectAllSlides.addEventListener('change', toggleSelectAllSlides);
        function handleFile(file) {
            const validTypes = ['application/vnd.ms-powerpoint','application/vnd.openxmlformats-officedocument.presentationml.presentation'];
            if (!validTypes.includes(file.type) && !file.name.match(/\.(pptx|ppt)$/i)) { showError('Please select a valid PowerPoint file (.pptx or .ppt)'); return; }
            if (file.size > 50 * 1024 * 1024) { showError('File size exceeds 50MB limit. Please choose a smaller file.'); return; }
            currentFile = file; fileName.textContent = file.name; fileSize.textContent = formatFileSize(file.size); fileInfo.style.display = 'block'; convertBtn.disabled = false; hideMessages(); previewSection.style.display = 'none';
            simulatePresentationLoad(file);
        }
        function simulatePresentationLoad(file) {
            updateProgress(10, 'Reading PowerPoint file...');
            setTimeout(() => {
                updateProgress(30, 'Parsing presentation...');
                totalSlides = Math.floor(Math.random() * 15) + 5; // 5-20 slides
                presentationData = [];
                for (let i = 1; i <= totalSlides; i++) {
                    presentationData.push({ number: i, title: `Slide ${i}`, content: generateMockSlideContent(i), notes: i % 3 === 0 ? `Speaker notes for slide ${i}` : null });
                }
                populateSlideSelection(totalSlides);
                slideSelection.style.display = 'block';
                selectedSlides = Array.from({length: totalSlides}, (_, i) => i + 1);
                updateSlideSelectionUI();
                renderPreview(1);
                updateProgress(100, 'Presentation loaded successfully');
                setTimeout(() => { progressContainer.style.display = 'none'; progressBar.style.width = '0%'; }, 1000);
            }, 2000);
        }
        function generateMockSlideContent(slideNumber) {
            const titles = ["Project Overview","Market Analysis","Key Findings","Methodology","Results & Discussion","Conclusion","Recommendations","Next Steps","Q&A"]; const contents = [
                "<p>This presentation provides an overview of our latest project initiatives and key milestones.</p>",
                "<p>Our analysis shows significant growth opportunities in the target market segment.</p><ul><li>Market size: $50B</li><li>Growth rate: 15% annually</li><li>Key competitors: 3 major players</li></ul>",
                "<p>The research revealed several important insights that will guide our strategy.</p><ol><li>Customer preferences are shifting</li><li>Technology adoption is accelerating</li><li>New market segments are emerging</li></ol>",
                "<p>We employed a mixed-methods approach combining quantitative and qualitative research.</p>",
                "<p>The results demonstrate clear alignment with our initial hypotheses and show promising outcomes.</p>",
                "<p>In conclusion, the data supports moving forward with the proposed strategy with some adjustments.</p>",
                "<p>We recommend the following actions to capitalize on the identified opportunities.</p>",
                "<p>The next phase will focus on implementation and monitoring of key performance indicators.</p>",
                "<p>Thank you for your attention. We welcome any questions or feedback.</p>"
            ];
            const titleIndex = (slideNumber - 1) % titles.length; const contentIndex = (slideNumber - 1) % contents.length; return { title: titles[titleIndex], content: contents[contentIndex] };
        }
        function populateSlideSelection(totalSlides) {
            slideList.innerHTML = '';
            for (let i = 1; i <= totalSlides; i++) {
                const slideItem = document.createElement('div');
                slideItem.className = 'slide-item active';
                slideItem.dataset.slideNumber = i;
                slideItem.innerHTML = `<i class="fas fa-check-circle"></i><span>Slide ${i}</span>`;
                slideItem.addEventListener('click', () => { toggleSlideSelection(i); });
                slideList.appendChild(slideItem);
            }
        }
        function toggleSlideSelection(slideNumber) {
            const index = selectedSlides.indexOf(slideNumber);
            if (index > -1) selectedSlides.splice(index, 1); else selectedSlides.push(slideNumber);
            updateSlideSelectionUI();
            if (selectedSlides.length === 1) renderPreview(selectedSlides[0]); else previewSection.style.display = 'none';
        }
        function updateSlideSelectionUI() {
            document.querySelectorAll('.slide-item').forEach(item => {
                const n = parseInt(item.dataset.slideNumber, 10);
                if (selectedSlides.includes(n)) { item.classList.add('active'); item.querySelector('i').className = 'fas fa-check-circle'; }
                else { item.classList.remove('active'); item.querySelector('i').className = 'far fa-circle'; }
            });
            selectAllSlides.checked = selectedSlides.length === totalSlides;
        }
        function toggleSelectAllSlides() {
            selectedSlides = selectAllSlides.checked ? Array.from({length: totalSlides}, (_, i) => i + 1) : [];
            updateSlideSelectionUI();
            if (selectedSlides.length !== 1) previewSection.style.display = 'none'; else renderPreview(selectedSlides[0]);
        }
        function renderPreview(slideNumber) {
            if (!presentationData) return;
            try {
                const slide = presentationData[slideNumber - 1];
                if (!slide) { showError('Selected slide is not available.'); return; }
                const includeNotes = document.getElementById('include-notes').checked;
                let previewHTML = `<div class="slide-preview" style="background:#f8f9fa;border:1px solid #dee2e6;border-radius:8px;padding:20px;margin-bottom:15px;">`+
                    `<div class="slide-header" style="font-size:1.1rem;font-weight:600;color:var(--primary);margin-bottom:10px;padding-bottom:8px;border-bottom:2px solid var(--primary);">${slide.content.title}</div>`+
                    `<div class="slide-content">${slide.content.content}</div>`;
                if (includeNotes && slide.notes) {
                    previewHTML += `<div style="margin-top: 15px; padding-top: 10px; border-top: 1px dashed #ccc;"><strong>Speaker Notes:</strong><p style="margin-top: 5px; font-style: italic;">${slide.notes}</p></div>`;
                }
                previewHTML += `</div>`;
                previewContainer.innerHTML = previewHTML; previewSection.style.display = 'block'; previewNote.textContent = ` â€¢ Slide: ${slideNumber}`;
            } catch (e) { console.error('Preview render error:', e); showError('Unable to render preview. Please try another file.'); }
        }
        async function convertToWord() {
            if (!currentFile || !presentationData || selectedSlides.length === 0) { showError('Please select a PowerPoint file and at least one slide'); return; }
            hideMessages(); loading.style.display = 'block'; progressContainer.style.display = 'block'; convertBtn.disabled = true;
            try {
                updateProgress(20, 'Preparing document...');
                const outputFormat = document.getElementById('output-format').value;
                const includeNotes = document.getElementById('include-notes').checked;
                const includeImages = document.getElementById('include-images').checked;
                const preserveFormatting = document.getElementById('preserve-formatting').checked;
                let documentContent = `<!DOCTYPE html><html><head><meta charset=\"UTF-8\"><title>${currentFile.name.replace(/\.[^/.]+$/, '')}</title><style>body{font-family:Arial, sans-serif; line-height:1.6; margin:40px}.slide{margin-bottom:30px; padding-bottom:20px; border-bottom:1px solid #eee}.slide-title{font-size:24px; font-weight:bold; color:#d35400; margin-bottom:15px}.notes{background:#f9f9f9; padding:15px; border-left:4px solid #d35400; margin-top:15px; font-style:italic}ul,ol{margin-left:20px}</style></head><body><h1>${currentFile.name.replace(/\.[^/.]+$/, '')}</h1><p>Converted from PowerPoint presentation on ${new Date().toLocaleDateString()}</p><hr>`;
                for (let i = 0; i < selectedSlides.length; i++) {
                    const num = selectedSlides[i]; const slide = presentationData[num - 1];
                    updateProgress(20 + (i / selectedSlides.length) * 70, `Processing slide ${num}...`);
                    documentContent += `<div class=\"slide\"><div class=\"slide-title\">${slide.content.title}</div><div class=\"slide-content\">${slide.content.content}</div>`;
                    if (includeNotes && slide.notes) { documentContent += `<div class=\"notes\"><strong>Speaker Notes:</strong><br>${slide.notes}</div>`; }
                    documentContent += `</div>`;
                    await new Promise(r => setTimeout(r, 200));
                }
                documentContent += `</body></html>`;
                updateProgress(95, 'Finalizing document...');
                let downloadUrl, downloadName;
                if (outputFormat === 'pdf') {
                    const { jsPDF } = window.jspdf; const pdf = new jsPDF();
                    const tempDiv = document.createElement('div'); tempDiv.innerHTML = documentContent; document.body.appendChild(tempDiv);
                    const canvas = await html2canvas(tempDiv, { scale: 2, useCORS: true, backgroundColor: '#ffffff' });
                    const imgData = canvas.toDataURL('image/jpeg', 0.9); pdf.addImage(imgData, 'JPEG', 10, 10, 190, 0);
                    document.body.removeChild(tempDiv);
                    const dataUrl = pdf.output('datauristring');
                    const outName = currentFile.name.replace(/\.[^/.]+$/, '') + '.pdf';
                    try {
                        sessionStorage.setItem('p2p_pdf_dataurl', dataUrl);
                        sessionStorage.setItem('p2p_filename', outName);
                        sessionStorage.setItem('p2p_pages', String(pdf.internal.getNumberOfPages()));
                    } catch (e) {
                        try { window.name = JSON.stringify({ tag:'P2P', p2p_pdf_dataurl:dataUrl, p2p_filename:outName, p2p_pages:String(pdf.internal.getNumberOfPages()) }); } catch(_){}
                    }
                    window.location.href = 'ppt-to-pdf-convert.html';
                    return;
                } else {
                    const blob = new Blob([documentContent], { type: outputFormat === 'txt' ? 'text/plain' : 'application/msword' });
                    downloadUrl = URL.createObjectURL(blob);
                    downloadName = currentFile.name.replace(/\.[^/.]+$/, '') + (outputFormat === 'txt' ? '.txt' : outputFormat === 'doc' ? '.doc' : '.docx');
                }
                const a = document.createElement('a'); a.href = downloadUrl; a.download = downloadName; document.body.appendChild(a); a.click(); document.body.removeChild(a); URL.revokeObjectURL(downloadUrl);
                updateProgress(100, 'Conversion complete!'); setTimeout(() => { successMessage.style.display = 'block'; }, 500);
            } catch (err) { console.error(err); showError('Failed to convert. Please try another file.'); }
            finally { loading.style.display = 'none'; progressContainer.style.display = 'none'; progressBar.style.width = '0%'; convertBtn.disabled = false; }
        }
        function clearFile() {
            currentFile = null; presentationData = null; selectedSlides = []; totalSlides = 0; fileInput.value = ''; fileInfo.style.display = 'none'; slideSelection.style.display = 'none'; convertBtn.disabled = true; hideMessages(); previewSection.style.display = 'none'; slideList.innerHTML = '';
        }
        function updateProgress(percent, text) { progressBar.style.width = `${percent}%`; progressText.textContent = text; }
        function formatFileSize(bytes) { if (bytes < 1024) return bytes + ' bytes'; else if (bytes < 1048576) return (bytes / 1024).toFixed(1) + ' KB'; else return (bytes / 1048576).toFixed(1) + ' MB'; }
        function showError(message) { errorText.textContent = message; errorMessage.style.display = 'block'; }
        function hideMessages() { successMessage.style.display = 'none'; errorMessage.style.display = 'none'; }
        document.getElementById('include-notes').addEventListener('change', () => { if (selectedSlides.length === 1) { renderPreview(selectedSlides[0]); } });
    </script>
</body>
</html>




